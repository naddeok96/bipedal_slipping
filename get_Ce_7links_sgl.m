function [C, C_onlyq] = get_Ce_7links_sgl(q,dq, model_params)
% Calculates the inertia matrix for single support
% Inputs:
%  ~ q: a vector of joint angles
%  ~ model_params: a data structure containing all of the model parameters
% Outputs:
%  ~ Ce: where the extended coordinates are qe = [q; xH; yH] where (xH, yH) are the
% position of the hip. 
%
% author:  Anne Martin
% created: 10/12/2012
% ported to MATLAB: 10/13/2013

% Set up
% Get the mass and length parameters out of the data structure
Lt    = model_params.Lt;
Ls    = model_params.Ls;
ct    = model_params.ct;
cs    = model_params.cs;
cf_x  = model_params.cf_x;
cf_y  = model_params.cf_y;
R_sgl     = model_params.R;
xf    = model_params.xf;
yf    = model_params.yf;
Mb    = model_params.mb;
Mt    = model_params.mt;
Ms    = model_params.ms;
mf    = model_params.mf;
Jt    = model_params.Jt;
Js    = model_params.Js;
% foot moment of inertia otherwise De is singular
Jf    = model_params.Jf;
J_torso=model_params.J_torso;
c_torso=model_params.c_torso;

g     = model_params.g;
gamma = model_params.gamma;

% Get the angles
q1 = q(1);
q2 = q(2);
q3 = q(3);
q4 = q(4);
q5 = q(5);
q6 = q(6);
q7 = q(7);

dq1 = dq(1);
dq2 = dq(2);
dq3 = dq(3);
dq4 = dq(4);
dq5 = dq(5);
dq6 = dq(6);
dq7 = dq(7);
dx  = dq(8);
dy  = dq(9);


% C matrix
C = zeros(9);
C(1,1) = dq5*(Ms*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Ms*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mb*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Mt*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mb*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) - dq7*(Mb*c_torso*cos(q1 + q7)*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mb*c_torso*sin(q1 + q7)*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) - dq1*(Ms*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mb*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Mt*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Ms*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Ms*(Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mb*(Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*(Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))) - dq4*(Ms*cs*cos(q1 + q2 + q4)*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*cs*sin(q1 + q2 + q4)*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) - dq3*(Ms*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Mb*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Ms*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Ms*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mb*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))) - dq2*(Ms*(Lt*cos(q1 + q2) + cs*cos(q1 + q2 + q4))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Lt*sin(q1 + q2) + cs*sin(q1 + q2 + q4))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*ct*cos(q1 + q2)*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*ct*sin(q1 + q2)*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)));
C(1,2) = dq2*(Lt^2*Ms*sin(q2) + Lt*Ms*R_sgl*sin(q1 + q2) + Lt*Ms*cs*sin(q2 + q4) + Mt*R_sgl*ct*sin(q1 + q2) + Lt*Mt*ct*sin(q2) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ls*Mt*ct*sin(q2 - q3) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) + dq4*(Lt*Ms*cs*sin(q2 + q4) - Lt*Ms*cs*sin(q4) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) - dq1*(Ms*(Lt*cos(q1 + q2) + cs*cos(q1 + q2 + q4))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Lt*sin(q1 + q2) + cs*sin(q1 + q2 + q4))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*ct*cos(q1 + q2)*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*ct*sin(q1 + q2)*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)));
C(1,3) = - dq5*(Lt*Mb*yf*cos(q3 + q5) - Mb*c_torso*xf*sin(q3 + q5 - q7) + Lt*Ms*yf*cos(q3 + q5) + 2*Lt*Mt*yf*cos(q3 + q5) + Lt*Mb*xf*sin(q3 + q5) + Lt*Ms*xf*sin(q3 + q5) + 2*Lt*Mt*xf*sin(q3 + q5) - Mt*ct*yf*cos(q3 + q5) - Mt*ct*xf*sin(q3 + q5) + Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) - Lt*Ms*yf*cos(q2 - q3 - q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) + Lt*Ms*xf*sin(q2 - q3 - q5) - Ms*cs*yf*cos(q5) - Mt*ct*yf*cos(q2 - q3 - q5) - Ms*cs*xf*sin(q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) - Mb*c_torso*yf*cos(q3 + q5 - q7)) - dq1*(Ms*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Mb*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Ms*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Ms*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mb*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))) - dq3*(Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Mb*c_torso*xf*sin(q3 + q5 - q7) + Lt*Mb*yf*cos(q3 + q5) - Ms*R_sgl*cs*sin(q1 + q3) + Lt*Ms*yf*cos(q3 + q5) + 2*Lt*Mt*yf*cos(q3 + q5) + Lt*Mb*xf*sin(q3 + q5) + Lt*Ms*xf*sin(q3 + q5) + 2*Lt*Mt*xf*sin(q3 + q5) + Ls*Lt*Mb*sin(q3) + Ls*Lt*Ms*sin(q3) + 2*Ls*Lt*Mt*sin(q3) - Mt*ct*yf*cos(q3 + q5) - Mt*ct*xf*sin(q3 + q5) - Ls*Mt*ct*sin(q3) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) - Ls*Mb*c_torso*sin(q3 - q7) + Ls*Mt*ct*sin(q2 - q3) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4) - Mb*c_torso*yf*cos(q3 + q5 - q7));
C(1,4) = dq2*(Lt*Ms*cs*sin(q2 + q4) - Lt*Ms*cs*sin(q4) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) + dq4*(Lt*Ms*cs*sin(q2 + q4) - Lt*Ms*cs*sin(q4) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) - dq1*(Ms*cs*cos(q1 + q2 + q4)*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*cs*sin(q1 + q2 + q4)*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)));
C(1,5) = dx*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) + dy*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5)) + dq1*(Ms*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Ms*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mb*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Mt*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mb*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) - dq3*(Lt*Mb*yf*cos(q3 + q5) - Mb*c_torso*xf*sin(q3 + q5 - q7) + Lt*Ms*yf*cos(q3 + q5) + 2*Lt*Mt*yf*cos(q3 + q5) + Lt*Mb*xf*sin(q3 + q5) + Lt*Ms*xf*sin(q3 + q5) + 2*Lt*Mt*xf*sin(q3 + q5) - Mt*ct*yf*cos(q3 + q5) - Mt*ct*xf*sin(q3 + q5) + Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) - Lt*Ms*yf*cos(q2 - q3 - q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) + Lt*Ms*xf*sin(q2 - q3 - q5) - Ms*cs*yf*cos(q5) - Mt*ct*yf*cos(q2 - q3 - q5) - Ms*cs*xf*sin(q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) - Mb*c_torso*yf*cos(q3 + q5 - q7)) - dq5*(Lt*Mb*yf*cos(q3 + q5) - Mb*c_torso*xf*sin(q3 + q5 - q7) + Lt*Ms*yf*cos(q3 + q5) + 2*Lt*Mt*yf*cos(q3 + q5) + Lt*Mb*xf*sin(q3 + q5) + Lt*Ms*xf*sin(q3 + q5) + 2*Lt*Mt*xf*sin(q3 + q5) - Mt*ct*yf*cos(q3 + q5) - Mt*ct*xf*sin(q3 + q5) + Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) - Lt*Ms*yf*cos(q2 - q3 - q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) + Lt*Ms*xf*sin(q2 - q3 - q5) - Ms*cs*yf*cos(q5) - Mt*ct*yf*cos(q2 - q3 - q5) - Ms*cs*xf*sin(q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) - Mb*c_torso*yf*cos(q3 + q5 - q7));
C(1,7) = - dq1*(Mb*c_torso*cos(q1 + q7)*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mb*c_torso*sin(q1 + q7)*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) - dq7*(Mb*c_torso*xf*sin(q3 + q5 - q7) - Mb*R_sgl*c_torso*sin(q1 + q7) - Lt*Mb*c_torso*sin(q7) + Ls*Mb*c_torso*sin(q3 - q7) + Mb*c_torso*yf*cos(q3 + q5 - q7));
C(1,8) = dq5*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5));
C(1,9) = dq5*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5));
C(2,1) = dq5*(Lt*Ms*yf*cos(q2 - q3 - q5) - Lt*Ms*xf*sin(q2 - q3 - q5) + Mt*ct*yf*cos(q2 - q3 - q5) - Mt*ct*xf*sin(q2 - q3 - q5) + Ms*cs*yf*cos(q2 - q3 + q4 - q5) - Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + dq1*(Ms*(Lt*cos(q1 + q2) + cs*cos(q1 + q2 + q4))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Lt*sin(q1 + q2) + cs*sin(q1 + q2 + q4))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Lt*Ms*R_sgl*sin(q1 + q2) + Mt*R_sgl*ct*sin(q1 + q2) + Mt*ct*cos(q1 + q2)*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Mt*ct*sin(q1 + q2)*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) - dq3*(Lt*Ms*xf*sin(q2 - q3 - q5) - Lt*Ms*yf*cos(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ls*Mt*ct*sin(q2 - q3) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) - Lt*Ms*cs*dq4*sin(q4);
C(2,2) = -Lt*Ms*cs*dq4*sin(q4);
C(2,3) = dq4*((Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2 + (Ls*Ms*cs*sin(q2 - q3 + q4))/2) + dq5*(Lt*Ms*yf*cos(q2 - q3 - q5) - Lt*Ms*xf*sin(q2 - q3 - q5) + Mt*ct*yf*cos(q2 - q3 - q5) - Mt*ct*xf*sin(q2 - q3 - q5) + Ms*cs*yf*cos(q2 - q3 + q4 - q5) - Ms*cs*xf*sin(q2 - q3 + q4 - q5)) - dq1*(Lt*Ms*xf*sin(q2 - q3 - q5) - Lt*Ms*yf*cos(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ls*Mt*ct*sin(q2 - q3) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) - dq3*(Lt*Ms*xf*sin(q2 - q3 - q5) - Lt*Ms*yf*cos(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ls*Mt*ct*sin(q2 - q3) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4));
C(2,4) = dq3*((Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2 + (Ls*Ms*cs*sin(q2 - q3 + q4))/2) - dq5*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 + (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 - (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2) - Lt*Ms*cs*dq1*sin(q4) - Lt*Ms*cs*dq2*sin(q4) - Lt*Ms*cs*dq4*sin(q4);
C(2,5) = dq1*(Lt*Ms*yf*cos(q2 - q3 - q5) - Lt*Ms*xf*sin(q2 - q3 - q5) + Mt*ct*yf*cos(q2 - q3 - q5) - Mt*ct*xf*sin(q2 - q3 - q5) + Ms*cs*yf*cos(q2 - q3 + q4 - q5) - Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + dq3*(Lt*Ms*yf*cos(q2 - q3 - q5) - Lt*Ms*xf*sin(q2 - q3 - q5) + Mt*ct*yf*cos(q2 - q3 - q5) - Mt*ct*xf*sin(q2 - q3 - q5) + Ms*cs*yf*cos(q2 - q3 + q4 - q5) - Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + dq5*(Lt*Ms*yf*cos(q2 - q3 - q5) - Lt*Ms*xf*sin(q2 - q3 - q5) + Mt*ct*yf*cos(q2 - q3 - q5) - Mt*ct*xf*sin(q2 - q3 - q5) + Ms*cs*yf*cos(q2 - q3 + q4 - q5) - Ms*cs*xf*sin(q2 - q3 + q4 - q5)) - dq4*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 + (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 - (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2);
C(3,1) = dq4*(Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) - dq5*(Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) - Ms*cs*yf*cos(q5) - Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) + dq2*(Lt*Ms*R_sgl*sin(q1 + q2) + Mt*R_sgl*ct*sin(q1 + q2) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ls*Mt*ct*sin(q2 - q3) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) - dq7*(Mb*c_torso*xf*sin(q3 + q5 - q7) - Mb*R_sgl*c_torso*sin(q1 + q7) + Ls*Mb*c_torso*sin(q3 - q7) + Mb*c_torso*yf*cos(q3 + q5 - q7)) - dq3*(Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Ms*R_sgl*cs*sin(q1 + q3) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq1*(Mt*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mb*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Ms*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Ms*(Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(Ls*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mb*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Mt*(Ls*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + 2*Ls*Mb*R_sgl*sin(q1 + q3) + 4*Ls*Ms*R_sgl*sin(q1 + q3) - Lt*Ms*R_sgl*sin(q1 + q2) + 4*Ls*Mt*R_sgl*sin(q1 + q3) - Mb*R_sgl*c_torso*sin(q1 + q7) - 2*Ms*R_sgl*cs*sin(q1 + q3) - Mt*R_sgl*ct*sin(q1 + q2) + Lt*Mb*R_sgl*sin(q1) + Lt*Ms*R_sgl*sin(q1) + 2*Lt*Mt*R_sgl*sin(q1) - Mt*R_sgl*ct*sin(q1) - Ms*R_sgl*cs*sin(q1 + q2 + q4) + 2*Mb*R_sgl*yf*cos(q1 + q3 + q5) + 4*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 4*Mt*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mb*R_sgl*xf*sin(q1 + q3 + q5) + 4*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 4*Mt*R_sgl*xf*sin(q1 + q3 + q5));
C(3,2) = dq4*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4) + R_sgl*sin(q1 + q2 + q4)))/2 + (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2 + (Ls*Ms*cs*sin(q2 - q3 + q4))/2) + dq1*(Lt*Ms*R_sgl*sin(q1 + q2) + Mt*R_sgl*ct*sin(q1 + q2) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ls*Mt*ct*sin(q2 - q3) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) + dq2*(Lt*Ms*R_sgl*sin(q1 + q2) + Mt*R_sgl*ct*sin(q1 + q2) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) + Ls*Lt*Ms*sin(q2 - q3) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ls*Mt*ct*sin(q2 - q3) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4));
C(3,3) = - dq5*(Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) - Ms*cs*yf*cos(q5) - Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq1*(Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Ms*R_sgl*cs*sin(q1 + q3) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq3*(Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Ms*R_sgl*cs*sin(q1 + q3) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5));
C(3,4) = dq2*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4) + R_sgl*sin(q1 + q2 + q4)))/2 + (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2 + (Ls*Ms*cs*sin(q2 - q3 + q4))/2) + dq1*(Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) + Ms*cs*dq4*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4) + R_sgl*sin(q1 + q2 + q4));
C(3,5) = dx*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) - dq3*(Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) - Ms*cs*yf*cos(q5) - Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq5*(Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) - Ms*cs*yf*cos(q5) - Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq1*(Ls*Mb*yf*cos(q5) + 2*Ls*Ms*yf*cos(q5) + 2*Ls*Mt*yf*cos(q5) + Ls*Mb*xf*sin(q5) + 2*Ls*Ms*xf*sin(q5) + 2*Ls*Mt*xf*sin(q5) - Ms*cs*yf*cos(q5) - Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) + dy*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5));
C(3,7) = - dq1*(Mb*c_torso*xf*sin(q3 + q5 - q7) - Mb*R_sgl*c_torso*sin(q1 + q7) + Ls*Mb*c_torso*sin(q3 - q7) + Mb*c_torso*yf*cos(q3 + q5 - q7)) - Mb*c_torso*dq7*(yf*cos(q3 + q5 - q7) + xf*sin(q3 + q5 - q7) - R_sgl*sin(q1 + q7) + Ls*sin(q3 - q7));
C(3,8) = dq5*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5));
C(3,9) = dq5*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5));
C(4,1) = dq1*(Ms*R_sgl*cs*sin(q1 + q2 + q4) + Ms*cs*cos(q1 + q2 + q4)*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*cs*sin(q1 + q2 + q4)*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) - dq3*(Ms*cs*xf*sin(q2 - q3 + q4 - q5) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) + dq5*(Ms*cs*yf*cos(q2 - q3 + q4 - q5) - Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + Lt*Ms*cs*dq2*sin(q4);
C(4,2) = dq5*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 + (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 - (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2) - dq3*((Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2 + (Ls*Ms*cs*sin(q2 - q3 + q4))/2) + Lt*Ms*cs*dq1*sin(q4) + Lt*Ms*cs*dq2*sin(q4);
C(4,3) = Ms*cs*dq5*(yf*cos(q2 - q3 + q4 - q5) - xf*sin(q2 - q3 + q4 - q5)) - dq1*(Ms*cs*xf*sin(q2 - q3 + q4 - q5) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ls*Ms*cs*sin(q2 - q3 + q4)) - dq2*((Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2 + (Ls*Ms*cs*sin(q2 - q3 + q4))/2) - Ms*cs*dq3*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + Ls*sin(q2 - q3 + q4));
C(4,5) = dq1*(Ms*cs*yf*cos(q2 - q3 + q4 - q5) - Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + dq2*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + R_sgl*sin(q1 + q2 + q4)))/2 - (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 + (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 - (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2) + Ms*cs*dq3*(yf*cos(q2 - q3 + q4 - q5) - xf*sin(q2 - q3 + q4 - q5)) + Ms*cs*dq5*(yf*cos(q2 - q3 + q4 - q5) - xf*sin(q2 - q3 + q4 - q5));
C(5,1) = dq4*(Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5)) - dq7*(Mb*c_torso*xf*sin(q3 + q5 - q7) - Mb*R_sgl*c_torso*sin(q1 + q7) + Mb*c_torso*yf*cos(q3 + q5 - q7)) - dq3*(Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Ms*R_sgl*cs*sin(q1 + q3) - Ls*Mb*yf*cos(q5) - 2*Ls*Ms*yf*cos(q5) - 2*Ls*Mt*yf*cos(q5) - Ls*Mb*xf*sin(q5) - 2*Ls*Ms*xf*sin(q5) - 2*Ls*Mt*xf*sin(q5) + Ms*cs*yf*cos(q5) + Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dx*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) - dy*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5)) - dq1*(Ms*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - cs*sin(q1 + q3) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - cs*cos(q1 + q3) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Ms*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - Lt*sin(q1 + q2) + Lt*sin(q1) - cs*sin(q1 + q2 + q4) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Ms*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - Lt*cos(q1 + q2) + Lt*cos(q1) - cs*cos(q1 + q2 + q4) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mb*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) + Mt*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) - ct*sin(q1 + q2) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mb*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) - Mt*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) - ct*cos(q1 + q2) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Mt*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Ls*sin(q1 + q3) + Lt*sin(q1) - ct*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mt*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(R_sgl + Ls*cos(q1 + q3) + Lt*cos(q1) - ct*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5)) + Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) - Lt*Ms*R_sgl*sin(q1 + q2) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Mb*R_sgl*c_torso*sin(q1 + q7) - Ms*R_sgl*cs*sin(q1 + q3) - Mt*R_sgl*ct*sin(q1 + q2) + Lt*Mb*R_sgl*sin(q1) + Lt*Ms*R_sgl*sin(q1) + 2*Lt*Mt*R_sgl*sin(q1) - Mt*R_sgl*ct*sin(q1) - Ms*R_sgl*cs*sin(q1 + q2 + q4) + 2*Mb*R_sgl*yf*cos(q1 + q3 + q5) + 4*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 4*Mt*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mb*R_sgl*xf*sin(q1 + q3 + q5) + 4*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 4*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq5*(Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) + dq2*(Lt*Ms*R_sgl*sin(q1 + q2) + Mt*R_sgl*ct*sin(q1 + q2) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5));
C(5,2) = dq1*(Lt*Ms*R_sgl*sin(q1 + q2) + Mt*R_sgl*ct*sin(q1 + q2) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + dq2*(Lt*Ms*R_sgl*sin(q1 + q2) + Mt*R_sgl*ct*sin(q1 + q2) - Lt*Ms*yf*cos(q2 - q3 - q5) + Lt*Ms*xf*sin(q2 - q3 - q5) - Mt*ct*yf*cos(q2 - q3 - q5) + Mt*ct*xf*sin(q2 - q3 - q5) + Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + dq4*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + R_sgl*sin(q1 + q2 + q4)))/2 + (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2);
C(5,3) = - dq1*(Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Ms*R_sgl*cs*sin(q1 + q3) - Ls*Mb*yf*cos(q5) - 2*Ls*Ms*yf*cos(q5) - 2*Ls*Mt*yf*cos(q5) - Ls*Mb*xf*sin(q5) - 2*Ls*Ms*xf*sin(q5) - 2*Ls*Mt*xf*sin(q5) + Ms*cs*yf*cos(q5) + Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq3*(Ls*Mb*R_sgl*sin(q1 + q3) + 2*Ls*Ms*R_sgl*sin(q1 + q3) + 2*Ls*Mt*R_sgl*sin(q1 + q3) - Ms*R_sgl*cs*sin(q1 + q3) - Ls*Mb*yf*cos(q5) - 2*Ls*Ms*yf*cos(q5) - 2*Ls*Mt*yf*cos(q5) - Ls*Mb*xf*sin(q5) - 2*Ls*Ms*xf*sin(q5) - 2*Ls*Mt*xf*sin(q5) + Ms*cs*yf*cos(q5) + Ms*cs*xf*sin(q5) + Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dx*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) - dy*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5)) - dq5*(Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5));
C(5,4) = dq1*(Ms*R_sgl*cs*sin(q1 + q2 + q4) - Ms*cs*yf*cos(q2 - q3 + q4 - q5) + Ms*cs*xf*sin(q2 - q3 + q4 - q5)) + dq2*((Ms*cs*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + R_sgl*sin(q1 + q2 + q4)))/2 + (Ms*R_sgl*cs*sin(q1 + q2 + q4))/2 - (Ms*cs*yf*cos(q2 - q3 + q4 - q5))/2 + (Ms*cs*xf*sin(q2 - q3 + q4 - q5))/2) + Ms*cs*dq4*(xf*sin(q2 - q3 + q4 - q5) - yf*cos(q2 - q3 + q4 - q5) + R_sgl*sin(q1 + q2 + q4));
C(5,5) = - dq1*(Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq3*(Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5)) - dq5*(Mb*R_sgl*yf*cos(q1 + q3 + q5) + 2*Ms*R_sgl*yf*cos(q1 + q3 + q5) + 2*Mt*R_sgl*yf*cos(q1 + q3 + q5) + Mb*R_sgl*xf*sin(q1 + q3 + q5) + 2*Ms*R_sgl*xf*sin(q1 + q3 + q5) + 2*Mt*R_sgl*xf*sin(q1 + q3 + q5));
C(5,7) = - dq1*(Mb*c_torso*xf*sin(q3 + q5 - q7) - Mb*R_sgl*c_torso*sin(q1 + q7) + Mb*c_torso*yf*cos(q3 + q5 - q7)) - Mb*c_torso*dq7*(yf*cos(q3 + q5 - q7) + xf*sin(q3 + q5 - q7) - R_sgl*sin(q1 + q7));
C(5,8) = - dq1*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) - dq3*((Mb*yf*cos(q1 + q3 + q5))/2 - ((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5));
C(5,9) = - dq1*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5)) - dq3*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 - (Mb*xf*cos(q1 + q3 + q5))/2 - Ms*xf*cos(q1 + q3 + q5) - Mt*xf*cos(q1 + q3 + q5) + (Mb*yf*sin(q1 + q3 + q5))/2 + Ms*yf*sin(q1 + q3 + q5) + Mt*yf*sin(q1 + q3 + q5));
C(7,1) = dq5*(Mb*c_torso*xf*sin(q3 + q5 - q7) + Mb*c_torso*yf*cos(q3 + q5 - q7)) + dq1*(Mb*R_sgl*c_torso*sin(q1 + q7) + Mb*c_torso*cos(q1 + q7)*(Ls*sin(q1 + q3) - c_torso*sin(q1 + q7) + Lt*sin(q1) + yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5)) - Mb*c_torso*sin(q1 + q7)*(R_sgl + Ls*cos(q1 + q3) - c_torso*cos(q1 + q7) + Lt*cos(q1) + xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))) + dq3*(Mb*c_torso*xf*sin(q3 + q5 - q7) + Ls*Mb*c_torso*sin(q3 - q7) + Mb*c_torso*yf*cos(q3 + q5 - q7));
C(7,3) = dq1*(Mb*c_torso*xf*sin(q3 + q5 - q7) + Ls*Mb*c_torso*sin(q3 - q7) + Mb*c_torso*yf*cos(q3 + q5 - q7)) + Mb*c_torso*dq3*(yf*cos(q3 + q5 - q7) + xf*sin(q3 + q5 - q7) + Ls*sin(q3 - q7)) + Mb*c_torso*dq5*(yf*cos(q3 + q5 - q7) + xf*sin(q3 + q5 - q7));
C(7,5) = dq1*(Mb*c_torso*xf*sin(q3 + q5 - q7) + Mb*c_torso*yf*cos(q3 + q5 - q7)) + Mb*c_torso*dq3*(yf*cos(q3 + q5 - q7) + xf*sin(q3 + q5 - q7)) + Mb*c_torso*dq5*(yf*cos(q3 + q5 - q7) + xf*sin(q3 + q5 - q7));
C(8,1) = dq5*(((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*yf*cos(q1 + q3 + q5))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) + dq1*(Mb*yf*cos(q1 + q3 + q5) - Ms*cs*sin(q1 + q2 + q4) + 2*Ms*yf*cos(q1 + q3 + q5) + 2*Mt*yf*cos(q1 + q3 + q5) + Mb*xf*sin(q1 + q3 + q5) + 2*Ms*xf*sin(q1 + q3 + q5) + 2*Mt*xf*sin(q1 + q3 + q5) + Ls*Mb*sin(q1 + q3) + 2*Ls*Ms*sin(q1 + q3) - Lt*Ms*sin(q1 + q2) + 2*Ls*Mt*sin(q1 + q3) - Mb*c_torso*sin(q1 + q7) - Ms*cs*sin(q1 + q3) - Mt*ct*sin(q1 + q2) + Lt*Mb*sin(q1) + Lt*Ms*sin(q1) + 2*Lt*Mt*sin(q1) - Mt*ct*sin(q1)) + dq3*(Mb*yf*cos(q1 + q3 + q5) + 2*Ms*yf*cos(q1 + q3 + q5) + 2*Mt*yf*cos(q1 + q3 + q5) + Mb*xf*sin(q1 + q3 + q5) + 2*Ms*xf*sin(q1 + q3 + q5) + 2*Mt*xf*sin(q1 + q3 + q5) + Ls*Mb*sin(q1 + q3) + 2*Ls*Ms*sin(q1 + q3) + 2*Ls*Mt*sin(q1 + q3) - Ms*cs*sin(q1 + q3)) - dq2*(Ms*cs*sin(q1 + q2 + q4) + Lt*Ms*sin(q1 + q2) + Mt*ct*sin(q1 + q2)) - Mb*c_torso*dq7*sin(q1 + q7) - Ms*cs*dq4*sin(q1 + q2 + q4);
C(8,2) = - dq1*(Ms*cs*sin(q1 + q2 + q4) + Lt*Ms*sin(q1 + q2) + Mt*ct*sin(q1 + q2)) - dq2*(Ms*cs*sin(q1 + q2 + q4) + Lt*Ms*sin(q1 + q2) + Mt*ct*sin(q1 + q2)) - Ms*cs*dq4*sin(q1 + q2 + q4);
C(8,3) = dq5*(((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*yf*cos(q1 + q3 + q5))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) + dq1*(Mb*yf*cos(q1 + q3 + q5) + 2*Ms*yf*cos(q1 + q3 + q5) + 2*Mt*yf*cos(q1 + q3 + q5) + Mb*xf*sin(q1 + q3 + q5) + 2*Ms*xf*sin(q1 + q3 + q5) + 2*Mt*xf*sin(q1 + q3 + q5) + Ls*Mb*sin(q1 + q3) + 2*Ls*Ms*sin(q1 + q3) + 2*Ls*Mt*sin(q1 + q3) - Ms*cs*sin(q1 + q3)) + dq3*(Mb*yf*cos(q1 + q3 + q5) + 2*Ms*yf*cos(q1 + q3 + q5) + 2*Mt*yf*cos(q1 + q3 + q5) + Mb*xf*sin(q1 + q3 + q5) + 2*Ms*xf*sin(q1 + q3 + q5) + 2*Mt*xf*sin(q1 + q3 + q5) + Ls*Mb*sin(q1 + q3) + 2*Ls*Ms*sin(q1 + q3) + 2*Ls*Mt*sin(q1 + q3) - Ms*cs*sin(q1 + q3));
C(8,4) = - Ms*cs*dq1*sin(q1 + q2 + q4) - Ms*cs*dq2*sin(q1 + q2 + q4) - Ms*cs*dq4*sin(q1 + q2 + q4);
C(8,5) = dq1*(((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*yf*cos(q1 + q3 + q5))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) + dq3*(((yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*yf*cos(q1 + q3 + q5))/2 + Ms*yf*cos(q1 + q3 + q5) + Mt*yf*cos(q1 + q3 + q5) + (Mb*xf*sin(q1 + q3 + q5))/2 + Ms*xf*sin(q1 + q3 + q5) + Mt*xf*sin(q1 + q3 + q5)) + dq5*(yf*cos(q1 + q3 + q5) + xf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt);
C(8,7) = - Mb*c_torso*dq1*sin(q1 + q7) - Mb*c_torso*dq7*sin(q1 + q7);
C(9,1) = dq2*(Ms*cs*cos(q1 + q2 + q4) + Lt*Ms*cos(q1 + q2) + Mt*ct*cos(q1 + q2)) - dq5*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*xf*cos(q1 + q3 + q5))/2 + Ms*xf*cos(q1 + q3 + q5) + Mt*xf*cos(q1 + q3 + q5) - (Mb*yf*sin(q1 + q3 + q5))/2 - Ms*yf*sin(q1 + q3 + q5) - Mt*yf*sin(q1 + q3 + q5)) - dq3*(Mb*xf*cos(q1 + q3 + q5) + 2*Ms*xf*cos(q1 + q3 + q5) + 2*Mt*xf*cos(q1 + q3 + q5) - Mb*yf*sin(q1 + q3 + q5) - 2*Ms*yf*sin(q1 + q3 + q5) - 2*Mt*yf*sin(q1 + q3 + q5) + Ls*Mb*cos(q1 + q3) + 2*Ls*Ms*cos(q1 + q3) + 2*Ls*Mt*cos(q1 + q3) - Ms*cs*cos(q1 + q3)) + dq1*(Ms*cs*cos(q1 + q2 + q4) - Mb*xf*cos(q1 + q3 + q5) - 2*Ms*xf*cos(q1 + q3 + q5) - 2*Mt*xf*cos(q1 + q3 + q5) + Mb*yf*sin(q1 + q3 + q5) + 2*Ms*yf*sin(q1 + q3 + q5) + 2*Mt*yf*sin(q1 + q3 + q5) - Ls*Mb*cos(q1 + q3) - 2*Ls*Ms*cos(q1 + q3) + Lt*Ms*cos(q1 + q2) - 2*Ls*Mt*cos(q1 + q3) + Mb*c_torso*cos(q1 + q7) + Ms*cs*cos(q1 + q3) + Mt*ct*cos(q1 + q2) - Lt*Mb*cos(q1) - Lt*Ms*cos(q1) - 2*Lt*Mt*cos(q1) + Mt*ct*cos(q1)) + Mb*c_torso*dq7*cos(q1 + q7) + Ms*cs*dq4*cos(q1 + q2 + q4);
C(9,2) = dq1*(Ms*cs*cos(q1 + q2 + q4) + Lt*Ms*cos(q1 + q2) + Mt*ct*cos(q1 + q2)) + dq2*(Ms*cs*cos(q1 + q2 + q4) + Lt*Ms*cos(q1 + q2) + Mt*ct*cos(q1 + q2)) + Ms*cs*dq4*cos(q1 + q2 + q4);
C(9,3) = - dq1*(Mb*xf*cos(q1 + q3 + q5) + 2*Ms*xf*cos(q1 + q3 + q5) + 2*Mt*xf*cos(q1 + q3 + q5) - Mb*yf*sin(q1 + q3 + q5) - 2*Ms*yf*sin(q1 + q3 + q5) - 2*Mt*yf*sin(q1 + q3 + q5) + Ls*Mb*cos(q1 + q3) + 2*Ls*Ms*cos(q1 + q3) + 2*Ls*Mt*cos(q1 + q3) - Ms*cs*cos(q1 + q3)) - dq3*(Mb*xf*cos(q1 + q3 + q5) + 2*Ms*xf*cos(q1 + q3 + q5) + 2*Mt*xf*cos(q1 + q3 + q5) - Mb*yf*sin(q1 + q3 + q5) - 2*Ms*yf*sin(q1 + q3 + q5) - 2*Mt*yf*sin(q1 + q3 + q5) + Ls*Mb*cos(q1 + q3) + 2*Ls*Ms*cos(q1 + q3) + 2*Ls*Mt*cos(q1 + q3) - Ms*cs*cos(q1 + q3)) - dq5*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*xf*cos(q1 + q3 + q5))/2 + Ms*xf*cos(q1 + q3 + q5) + Mt*xf*cos(q1 + q3 + q5) - (Mb*yf*sin(q1 + q3 + q5))/2 - Ms*yf*sin(q1 + q3 + q5) - Mt*yf*sin(q1 + q3 + q5));
C(9,4) = Ms*cs*dq1*cos(q1 + q2 + q4) + Ms*cs*dq2*cos(q1 + q2 + q4) + Ms*cs*dq4*cos(q1 + q2 + q4);
C(9,5) = - dq1*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*xf*cos(q1 + q3 + q5))/2 + Ms*xf*cos(q1 + q3 + q5) + Mt*xf*cos(q1 + q3 + q5) - (Mb*yf*sin(q1 + q3 + q5))/2 - Ms*yf*sin(q1 + q3 + q5) - Mt*yf*sin(q1 + q3 + q5)) - dq3*(((xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt))/2 + (Mb*xf*cos(q1 + q3 + q5))/2 + Ms*xf*cos(q1 + q3 + q5) + Mt*xf*cos(q1 + q3 + q5) - (Mb*yf*sin(q1 + q3 + q5))/2 - Ms*yf*sin(q1 + q3 + q5) - Mt*yf*sin(q1 + q3 + q5)) - dq5*(xf*cos(q1 + q3 + q5) - yf*sin(q1 + q3 + q5))*(Mb + 2*Ms + 2*Mt);
C(9,7) = Mb*c_torso*dq1*cos(q1 + q7) + Mb*c_torso*dq7*cos(q1 + q7);

C_onlyq=C(1:7,1:7);

